# 鬼牌游戏 - 项目设置指南

## 一、前置要求

1. **Godot Engine 4.6** 或更高版本
2. **GodotSteam 插件** 已安装并配置
3. **Steam SDK** 已配置

## 二、项目结构

```
鬼牌/
├── Scripts/
│   ├── Autoload/          # 自动加载脚本（已配置）
│   │   ├── SteamManager.gd
│   │   ├── NetworkManager.gd
│   │   └── GameManager.gd
│   ├── Cards/
│   │   ├── Card.gd
│   │   └── Deck.gd
│   ├── UI/
│   │   ├── MainMenu.gd
│   │   ├── Lobby.gd
│   │   ├── Game.gd
│   │   └── CardUI.gd
│   └── Player/
├── Scenes/               # 场景文件（需要手动创建）
│   ├── MainMenu.tscn
│   ├── Lobby.tscn
│   └── Game.tscn
└── Resources/
    ├── Cards/            # 卡牌图片
    ├── Audio/            # 音效音乐
    └── UI/               # UI资源
```

## 三、创建场景文件

### 1. 创建主菜单场景（MainMenu.tscn）

在 Godot 编辑器中：

1. **场景 → 新建场景**
2. 选择 **User Interface** 作为根节点
3. 将根节点重命名为 `MainMenu`
4. 附加脚本：`res://鬼牌/Scripts/UI/MainMenu.gd`

#### 添加子节点（按以下层级结构）：

```
MainMenu (Control) - [MainMenu.gd]
└── VBoxContainer
    ├── StatusLabel (Label)
    ├── CreateRoomButton (Button) - 文本："创建房间"
    ├── JoinRoomButton (Button) - 文本："加入房间"
    ├── RoomCodeContainer (HBoxContainer)
    │   ├── Label - 文本："房间码："
    │   └── RoomCodeInput (LineEdit)
    └── SettingsContainer (VBoxContainer)
        ├── HBoxContainer
        │   ├── Label - 文本："最大玩家数："
        │   └── PlayerCountSpinBox (SpinBox)
        └── HBoxContainer
            ├── Label - 文本："质疑时间（秒）："
            └── ChallengeTimeSpinBox (SpinBox)
```

5. **保存场景**到 `res://鬼牌/Scenes/MainMenu.tscn`
6. **设置为主场景**：项目 → 项目设置 → Application → Run → Main Scene

---

### 2. 创建房间大厅场景（Lobby.tscn）

1. **场景 → 新建场景**
2. 选择 **User Interface**
3. 根节点重命名为 `Lobby`
4. 附加脚本：`res://鬼牌/Scripts/UI/Lobby.gd`

#### 添加子节点：

```
Lobby (Control) - [Lobby.gd]
└── VBoxContainer
    ├── RoomCodeLabel (Label)
    ├── StatusLabel (Label)
    ├── PlayerListContainer (VBoxContainer)
    ├── ReadyButton (Button) - 文本："准备"
    ├── StartGameButton (Button) - 文本："开始游戏"
    └── LeaveButton (Button) - 文本："离开房间"
```

5. **保存场景**到 `res://鬼牌/Scenes/Lobby.tscn`

---

### 3. 创建游戏主场景（Game.tscn）

1. **场景 → 新建场景**
2. 选择 **User Interface**
3. 根节点重命名为 `Game`
4. 附加脚本：`res://鬼牌/Scripts/UI/Game.gd`

#### 添加子节点：

```
Game (Control) - [Game.gd]
├── HandContainer (HBoxContainer) - 位于屏幕底部
├── TableArea (Panel) - 位于屏幕中央
│   ├── TableCardsLabel (Label)
│   └── CurrentClaimLabel (Label)
├── PlayPanel (Panel) - 出牌面板
│   └── VBoxContainer
│       ├── RankOptionButton (OptionButton)
│       ├── CardCountSpinBox (SpinBox)
│       ├── IsLyingCheckBox (CheckBox) - 文本："撒谎"
│       └── PlayButton (Button) - 文本："出牌"
├── ResponsePanel (Panel) - 响应面板
│   └── VBoxContainer
│       ├── ChallengeButton (Button) - 文本："质疑"
│       ├── FollowButton (Button) - 文本："跟牌"
│       ├── PassButton (Button) - 文本："过牌"
│       └── TimerLabel (Label)
├── PlayerInfoContainer (VBoxContainer) - 位于右侧
├── StatusLabel (Label) - 位于顶部
└── MyCardCountLabel (Label) - 位于底部
```

5. **保存场景**到 `res://鬼牌/Scenes/Game.tscn`

---

## 四、资源文件准备

### 1. 卡牌图片

将扑克牌图片放置到 `res://鬼牌/Resources/Cards/` 目录下，命名规则：

- 普通牌：`花色_点数.png`
  - 例如：`hearts_a.png`、`spades_10.png`
- 鬼牌：`joker_small.png`、`joker_big.png`

**支持的花色名称**：
- `hearts` - 红桃
- `diamonds` - 方块
- `clubs` - 梅花
- `spades` - 黑桃

**支持的点数名称**：
- `a`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9`, `10`, `j`, `q`, `k`

### 2. 音效音乐

将音效文件放置到 `res://鬼牌/Resources/Audio/` 目录下：

- `card_play.wav` - 出牌音效
- `challenge.wav` - 质疑音效
- `win.wav` - 胜利音效
- `bgm.mp3` - 背景音乐

### 3. UI资源

将UI相关图片放置到 `res://鬼牌/Resources/UI/` 目录下：

- `card_back.png` - 牌背图片
- `table_bg.png` - 牌桌背景
- `button_normal.png` - 按钮默认状态
- `button_hover.png` - 按钮悬停状态

---

## 五、GodotSteam 配置

### 1. Steam 初始化文件

在项目根目录创建 `steam_appid.txt`，内容为：

```
480
```

（测试时使用 480 - Spacewar，正式发布时替换为你的 Steam App ID）

### 2. 确认 GodotSteam 插件已启用

项目 → 项目设置 → 插件 → 勾选 GodotSteam

---

## 六、运行项目

1. **启动 Steam 客户端**
2. **在 Godot 编辑器中点击运行**
3. 确认 Steam 初始化成功
4. 创建房间或加入房间进行测试

---

## 七、多人联机测试

### 方法一：本地测试

1. 导出项目为可执行文件
2. 运行多个实例
3. 确保都登录了不同的 Steam 账号

### 方法二：好友测试

1. 玩家A创建房间，获取房间码
2. 玩家B输入房间码加入
3. 或通过 Steam 好友列表邀请

---

## 八、常见问题

### Q1: Steam 初始化失败
**解决方法**：
- 确认 Steam 客户端正在运行
- 检查 `steam_appid.txt` 文件是否存在
- 确认 GodotSteam 插件已正确安装

### Q2: 找不到场景文件
**解决方法**：
- 确认场景文件路径正确
- 使用 `res://鬼牌/Scenes/` 路径前缀

### Q3: 卡牌图片不显示
**解决方法**：
- 确认图片文件命名正确（小写）
- 检查图片文件格式（PNG）
- 确认图片已导入到 Godot 项目中

### Q4: P2P 连接失败
**解决方法**：
- 确认双方都在 Steam 好友列表中
- 检查防火墙设置
- 确认网络连接正常

---

## 九、下一步开发

### 推荐添加的功能：

1. **音效系统** - 为出牌、质疑等添加音效
2. **动画效果** - 卡牌飞出动画、翻牌动画
3. **聊天系统** - 玩家之间发送消息
4. **战绩统计** - 记录胜负次数
5. **皮肤系统** - 自定义卡牌背面和牌桌
6. **AI玩家** - 单人模式支持

---

## 十、联系与支持

如有问题，请查看：
- Godot 官方文档：https://docs.godotengine.org/
- GodotSteam 文档：https://godotsteam.com/

祝游戏开发顺利！

---

**明日之歌工作室**
开发人员：周義坤、孙钰章
